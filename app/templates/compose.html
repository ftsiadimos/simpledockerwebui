{% extends 'base.html' %}

{% block content %}
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #f8f9fa;
  }
  .table {
    background-color: #ffffff;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  }
  .table thead th {
    background-color: #000000 !important;
    color: #080202 !important;
    border: none;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  .table tbody tr:hover {
    background-color: #e9ecef;
  }
  .badge {
    font-size: 0.85em;
    padding: 0.5em 0.75em;
  }
  .btn {
    border-radius: 6px;
    font-weight: 500;
  }
  .btn-success {
    background-color: #00c853;
    border-color: #00c853;
  }
  .btn-success:hover {
    background-color: #00a844;
    border-color: #009639;
  }
  .btn-danger {
    background-color: #ff1744;
    border-color: #ff1744;
  }
  .btn-danger:hover {
    background-color: #d50000;
    border-color: #b71c1c;
  }
  .bg-success {
    background-color: #287046 !important;
  }
  .bg-danger {
    background-color: #ac0829 !important;
  }
  h2 {
    color: #343a40;
    font-weight: 700;
    margin-bottom: 1.5rem;
  }
  p {
    color: #000000;
    font-size: 1.1em;
  }
</style>
<div class="row">
  <div class="col-12">
    <h2>Docker Compose Management</h2>
    <p>Manage Docker Compose projects found in your home directory.</p>
    
    <div class="row mb-3">
      <div class="col-md-6">
        <div class="card text-white bg-success">
          <div class="card-body">
            <h5 class="card-title">Running Projects</h5>
            <p class="card-text">{{ running_count }}</p>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card text-white bg-danger">
          <div class="card-body">
            <h5 class="card-title">Stopped Projects</h5>
            <p class="card-text">{{ stopped_count }}</p>
          </div>
        </div>
      </div>
    </div>
    
    <div class="table-responsive">
      <table class="table table-striped table-hover" id="compose-table">
        <thead>
          <tr>
            <th>Path</th>
            <th>Services</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for project in compose_projects %}
          <tr>
            <td>{{ project.path }}</td>
            <td>
              <ul class="list-unstyled mb-0">
                {% for service in project.services %}
                <li>{{ service }}</li>
                {% endfor %}
              </ul>
            </td>
            <td>
              {% if project.running %}
              <span class="badge bg-success">Running</span>
              {% else %}
              <span class="badge bg-secondary">Stopped</span>
              {% endif %}
            </td>
            <td>
              <form method="post" class="d-inline">
                <input type="hidden" name="compose_dir" value="{{ project.dir }}">
                <button type="submit" name="action" value="start" class="btn btn-success btn-sm me-2" {% if project.running %}disabled{% endif %}>Start</button>
                <button type="submit" name="action" value="stop" class="btn btn-danger btn-sm" {% if not project.running %}disabled{% endif %}>Stop</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    
    {% if not compose_projects %}
    <p>No Docker Compose files found.</p>
    {% endif %}
  </div>
</div>

<script>
$(document).ready(function() {
    $('#compose-table').DataTable({
        "paging": false,
        "searching": true,
        "ordering": true,
        "info": false,
        "columnDefs": [
            { "orderable": false, "targets": 3 }  // Disable sorting on Actions column
        ]
    });
});
</script>

{% endblock %}